# Uniswap을 활용한 stETH 청산 전략 분석

## 제안 개요
stETH → ETH 전환 시 LIDO withdrawal 대기 시간(최대 며칠) 문제를 해결하기 위해 Uniswap DEX를 통한 즉시 청산

## 장점

### 즉시 유동성 확보
- LIDO withdrawal 대기 없이 즉시 ETH 확보
- 청산 속도 향상으로 프로토콜 리스크 감소
- 사용자 경험 개선 (빠른 담보 회수)

### 기술적 구현 용이성
- Uniswap V3 스마트 컨트랙트와 간단한 통합
- 이미 검증된 DEX 인프라 활용
- 자동화된 청산 프로세스 구현 가능

## 새로운 리스크

### 1. 슬리피지 및 가격 영향도

#### 정상 시장 조건
- 100 ETH 청산: 0.5-1% 슬리피지
- 500 ETH 청산: 1-2% 슬리피지
- 1000 ETH 청산: 3-5% 슬리피지

#### 스트레스 상황
- 시장 변동성 높을 때: 슬리피지 2-3배 증가
- 유동성 부족 시: 10% 이상 슬리피지 가능
- stETH depeg 시: 청산 불가능 수준

### 2. MEV 공격 취약성

#### 샌드위치 공격
```
1. MEV 봇이 청산 트랜잭션 감지
2. 청산 직전: stETH 대량 매도 → 가격 하락
3. 청산 실행: 더 나쁜 가격에 거래
4. 청산 직후: stETH 매수 → 봇 이익 실현
```

#### 예상 손실
- 일반 청산: 1-2% 추가 손실
- 대규모 청산: 3-5% 추가 손실
- 경쟁적 MEV 환경: 최대 10% 손실

### 3. 연쇄 청산 위험

#### 시나리오
```
1단계: 첫 청산 → stETH 대량 매도
2단계: stETH/ETH 가격 하락
3단계: 다른 포지션 담보율 악화
4단계: 추가 청산 트리거
5단계: 유동성 고갈 → 시스템 붕괴
```

#### 임계점
- 동시 청산 규모 > 유동성 풀의 5%: 위험
- 동시 청산 규모 > 유동성 풀의 10%: 매우 위험
- 동시 청산 규모 > 유동성 풀의 20%: 시스템 붕괴

### 4. 유동성 풀 의존성

#### 유동성 철수 리스크
- 시장 불안 시 LP들의 유동성 철수
- Uniswap V3 concentrated liquidity 특성상 범위 이탈 시 급격한 유동성 감소
- 경쟁 프로토콜로의 유동성 이동

#### 현재 유동성 수준 (예시)
- Uniswap V3 stETH/ETH: ~$500M TVL
- Curve stETH/ETH: ~$1B TVL
- 일일 거래량: ~$50-100M

## 하이브리드 해결책

### 1. 다층적 청산 전략

```
if (청산규모 < 100 ETH) {
    // 소규모: Uniswap 사용
    use Uniswap V3
} else if (청산규모 < 500 ETH) {
    // 중규모: DEX Aggregator 사용
    use 1inch/0x (여러 DEX 분산)
} else {
    // 대규모: 단계적 청산 + LIDO withdrawal
    부분청산(30%) via DEX
    나머지 LIDO withdrawal queue
}
```

### 2. DEX Aggregator 활용

#### 유동성 소스 다변화
- Uniswap V3
- Curve Finance (최대 유동성)
- Balancer V2
- Maverick Protocol
- 1inch Aggregation Protocol 통합

#### 장점
- 슬리피지 최소화
- 단일 DEX 의존성 해소
- 최적 경로 자동 탐색

### 3. 프로토콜 보험 풀

#### 구조
```
보험 풀 구성:
- 프로토콜 수수료의 20% 적립
- 초기 시드 펀딩: 1000 ETH
- 목표 규모: 전체 TVL의 5%
```

#### 활용 방안
- 긴급 청산 시 즉시 ETH 제공
- 슬리피지 손실 보상
- 시장 안정화 버퍼 역할

### 4. 청산 경매 메커니즘

#### Dutch Auction 방식
```
초기 가격: 담보가치의 95%
시간 경과: 1분마다 1% 할인
최소 가격: 담보가치의 80%
```

#### 장점
- 시장 기반 가격 발견
- MEV 공격 방어
- 청산자 간 경쟁 유도

## 구현 로드맵

### Phase 1 (MVP)
- 기본 Uniswap V3 통합
- 100 ETH 이하 청산만 허용
- 수동 모니터링 시스템

### Phase 2 (확장)
- 1inch Aggregator 통합
- 500 ETH까지 청산 확대
- 자동 슬리피지 보호

### Phase 3 (성숙)
- 프로토콜 보험 풀 운영
- Dutch Auction 청산
- 다중 청산 전략 자동 선택

## 위험 완화 파라미터

### 청산 제한
```solidity
MAX_SINGLE_LIQUIDATION = 100 ETH  // 단일 청산 최대
MAX_DAILY_LIQUIDATION = 1000 ETH  // 일일 청산 최대
MIN_POOL_LIQUIDITY = $10M         // 최소 유동성 요구
MAX_SLIPPAGE = 3%                 // 최대 허용 슬리피지
```

### 모니터링 지표
- stETH/ETH peg 편차
- DEX 유동성 수준
- 24시간 청산 규모
- MEV 활동 수준

## 결론

### Uniswap 활용 가능 조건
✅ 소규모 청산 (< 100 ETH)
✅ 정상 시장 조건
✅ 충분한 유동성 확보 시

### Uniswap 단독 사용 불가
❌ 대규모 청산 (> 500 ETH)
❌ 시장 스트레스 상황
❌ stETH depeg 이벤트

### 최종 권장사항

**하이브리드 접근 필수**
- Uniswap은 보조 수단으로만 활용
- 다중 DEX + LIDO withdrawal 조합
- 프로토콜 자체 보험 풀 필수
- 단계적 청산 메커니즘 구현

단순히 Uniswap만으로는 stETH 유동성 문제를 완전히 해결할 수 없으며, 오히려 새로운 리스크(MEV, 연쇄청산)를 도입합니다. 다층적 방어 체계 구축이 필수적입니다.